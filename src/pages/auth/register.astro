---
import AuthLayout from "../../layouts/AuthLayout.astro";
import { RegisterForm } from "../../components/auth/RegisterForm";
import { requireNoAuth } from "../../lib/utils/auth-guard";

export const prerender = false;

// Check if user is already logged in
requireNoAuth(Astro);

// Get error message from URL params
const errorParam = Astro.url.searchParams.get("error");
let errorMessage: string | null = null;

if (errorParam === "email-exists") {
  errorMessage = "Konto z tym adresem email już istnieje";
}

const title = "Rejestracja - VibeTravels";
---

<AuthLayout title={title}>
  <RegisterForm client:load initialError={errorMessage} />

  <div slot="footer">
    Masz już konto?
    <a href="/auth/login" class="font-medium text-primary hover:underline">Zaloguj się</a>
  </div>
</AuthLayout>
